<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Bun Enterprise Scanner Report</title>
  <style>
    :root {
      --md-primary: #1a73e8;
      --md-primary-container: #d3e3fd;
      --md-error: #d93025;
      --md-error-container: #fce8e6;
      --md-warning: #f9ab00;
      --md-warning-container: #fef7e0;
      --md-success: #1e8e3e;
      --md-success-container: #e6f4ea;
      --md-info: #1967d2;
      --md-info-container: #e8f0fe;
      --md-surface: #ffffff;
      --md-surface-variant: #f1f3f4;
      --md-background: #f8f9fa;
      --md-on-surface: #202124;
      --md-on-surface-variant: #5f6368;
      --md-outline: #dadce0;
      --md-shadow: rgba(0,0,0,0.1);
    }

    [data-theme="dark"] {
      --md-primary: #8ab4f8;
      --md-primary-container: #004a77;
      --md-error: #f28b82;
      --md-error-container: #8c1d18;
      --md-warning: #fdd663;
      --md-warning-container: #604c00;
      --md-success: #81c995;
      --md-success-container: #0d5223;
      --md-info: #8ab4f8;
      --md-info-container: #0d47a1;
      --md-surface: #1e1e1e;
      --md-surface-variant: #2d2d2d;
      --md-background: #121212;
      --md-on-surface: #e8eaed;
      --md-on-surface-variant: #9aa0a6;
      --md-outline: #3c4043;
      --md-shadow: rgba(0,0,0,0.3);
    }

    * { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      font-family: 'Google Sans', 'Roboto', -apple-system, sans-serif;
      background: var(--md-background);
      color: var(--md-on-surface);
      line-height: 1.6;
      transition: background 0.3s, color 0.3s;
    }

    .container {
      max-width: 1400px;
      margin: 0 auto;
      padding: 24px;
    }

    header {
      background: var(--md-surface);
      border: 1px solid var(--md-outline);
      padding: 16px 24px;
      margin-bottom: 24px;
      border-radius: 12px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
      gap: 16px;
      box-shadow: 0 1px 3px var(--md-shadow);
    }

    .header-left {
      display: flex;
      align-items: center;
      gap: 16px;
    }

    header h1 {
      font-size: 24px;
      font-weight: 500;
      color: var(--md-primary);
    }

    .header-actions {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .theme-toggle {
      background: var(--md-surface-variant);
      border: 1px solid var(--md-outline);
      border-radius: 20px;
      padding: 8px 16px;
      cursor: pointer;
      font-size: 14px;
      color: var(--md-on-surface);
      display: flex;
      align-items: center;
      gap: 6px;
      transition: all 0.2s;
    }

    .theme-toggle:hover {
      background: var(--md-primary-container);
    }

    .export-btn {
      background: var(--md-primary);
      color: white;
      border: none;
      border-radius: 20px;
      padding: 8px 16px;
      cursor: pointer;
      font-size: 14px;
      display: flex;
      align-items: center;
      gap: 6px;
      transition: all 0.2s;
    }

    .export-btn:hover {
      opacity: 0.9;
      transform: translateY(-1px);
    }

    .score-badge {
      font-size: 32px;
      font-weight: 700;
      padding: 8px 24px;
      border-radius: 24px;
      min-width: 120px;
      text-align: center;
    }

    .score-badge.excellent { background: var(--md-success-container); color: var(--md-success); }
    .score-badge.good { background: var(--md-warning-container); color: var(--md-warning); }
    .score-badge.poor { background: var(--md-error-container); color: var(--md-error); }

    .summary-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      gap: 16px;
      margin-bottom: 24px;
    }

    .summary-card {
      background: var(--md-surface);
      border: 1px solid var(--md-outline);
      border-radius: 12px;
      padding: 20px;
      text-align: center;
      transition: transform 0.2s, box-shadow 0.2s;
    }

    .summary-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px var(--md-shadow);
    }

    .summary-card .value {
      font-size: 28px;
      font-weight: 700;
      color: var(--md-primary);
    }

    .summary-card .label {
      font-size: 14px;
      color: var(--md-on-surface-variant);
      margin-top: 4px;
    }

    .severity-chart {
      background: var(--md-surface);
      border: 1px solid var(--md-outline);
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 24px;
    }

    .severity-chart h3 {
      font-size: 16px;
      font-weight: 500;
      margin-bottom: 16px;
      color: var(--md-on-surface);
    }

    .chart-bars {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .chart-row {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .chart-label {
      width: 80px;
      font-size: 13px;
      font-weight: 500;
      text-transform: capitalize;
    }

    .chart-bar-container {
      flex: 1;
      height: 24px;
      background: var(--md-surface-variant);
      border-radius: 12px;
      overflow: hidden;
    }

    .chart-bar {
      height: 100%;
      border-radius: 12px;
      transition: width 0.5s ease-out;
      display: flex;
      align-items: center;
      justify-content: flex-end;
      padding-right: 8px;
      font-size: 12px;
      font-weight: 600;
      color: white;
    }

    .chart-bar.error { background: var(--md-error); }
    .chart-bar.warning { background: var(--md-warning); color: #333; }
    .chart-bar.info { background: var(--md-info); }

    .chart-count {
      width: 40px;
      text-align: right;
      font-size: 14px;
      font-weight: 600;
    }

    .main-content {
      display: grid;
      grid-template-columns: 280px 1fr;
      gap: 24px;
    }

    @media (max-width: 900px) {
      .main-content {
        grid-template-columns: 1fr;
      }
    }

    .file-tree {
      background: var(--md-surface);
      border: 1px solid var(--md-outline);
      border-radius: 12px;
      padding: 16px;
      max-height: 600px;
      overflow-y: auto;
    }

    .file-tree h3 {
      font-size: 14px;
      font-weight: 500;
      margin-bottom: 12px;
      color: var(--md-on-surface-variant);
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .file-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 8px 12px;
      margin: 2px 0;
      border-radius: 8px;
      cursor: pointer;
      font-size: 13px;
      transition: background 0.15s;
    }

    .file-item:hover {
      background: var(--md-surface-variant);
    }

    .file-item.active {
      background: var(--md-primary-container);
    }

    .file-item.has-issues {
      color: var(--md-warning);
    }

    .file-item.clean {
      color: var(--md-success);
    }

    .file-issue-count {
      background: var(--md-warning-container);
      color: var(--md-warning);
      padding: 2px 8px;
      border-radius: 10px;
      font-size: 11px;
      font-weight: 600;
    }

    .file-issue-count.clean {
      background: var(--md-success-container);
      color: var(--md-success);
    }

    .path-parent {
      color: var(--md-on-surface-variant);
      font-weight: 400;
    }

    .file-name {
      font-family: 'SF Mono', 'Consolas', monospace;
      font-size: 12px;
    }

    .issues-panel {
      background: var(--md-surface);
      border: 1px solid var(--md-outline);
      border-radius: 12px;
      overflow: hidden;
    }

    .filter-bar {
      display: flex;
      gap: 12px;
      padding: 16px;
      background: var(--md-surface-variant);
      border-bottom: 1px solid var(--md-outline);
      flex-wrap: wrap;
    }

    .filter-group {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .filter-group label {
      font-size: 12px;
      color: var(--md-on-surface-variant);
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .filter-select {
      background: var(--md-surface);
      border: 1px solid var(--md-outline);
      border-radius: 8px;
      padding: 8px 12px;
      font-size: 14px;
      color: var(--md-on-surface);
      cursor: pointer;
    }

    .search-input {
      background: var(--md-surface);
      border: 1px solid var(--md-outline);
      border-radius: 8px;
      padding: 8px 12px;
      font-size: 14px;
      color: var(--md-on-surface);
      min-width: 200px;
    }

    .search-input::placeholder {
      color: var(--md-on-surface-variant);
    }

    .issues-table {
      width: 100%;
      border-collapse: collapse;
    }

    .issues-table th {
      background: var(--md-surface-variant);
      padding: 12px 16px;
      text-align: left;
      font-weight: 500;
      font-size: 12px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      color: var(--md-on-surface-variant);
      cursor: pointer;
      user-select: none;
      position: sticky;
      top: 0;
    }

    .issues-table th:hover {
      background: var(--md-outline);
    }

    .issues-table th .sort-icon {
      margin-left: 4px;
      opacity: 0.5;
    }

    .issues-table th.sorted .sort-icon {
      opacity: 1;
    }

    .issues-table td {
      padding: 12px 16px;
      border-top: 1px solid var(--md-outline);
      font-size: 14px;
    }

    .issues-table tr:hover {
      background: var(--md-surface-variant);
    }

    .severity-badge {
      display: inline-block;
      padding: 4px 10px;
      border-radius: 6px;
      font-size: 12px;
      font-weight: 500;
    }

    .severity-badge.error { background: var(--md-error-container); color: var(--md-error); }
    .severity-badge.warning { background: var(--md-warning-container); color: var(--md-warning); }
    .severity-badge.info { background: var(--md-info-container); color: var(--md-info); }

    .category-badge {
      display: inline-block;
      padding: 3px 8px;
      border-radius: 4px;
      font-size: 11px;
      font-weight: 600;
      background: var(--md-surface-variant);
      color: var(--md-on-surface-variant);
    }

    .file-link {
      font-family: 'Roboto Mono', 'SF Mono', monospace;
      font-size: 13px;
      color: var(--md-primary);
      text-decoration: none;
    }

    .file-link:hover {
      text-decoration: underline;
    }

    .line-number {
      font-family: 'Roboto Mono', 'SF Mono', monospace;
      font-size: 13px;
      color: var(--md-on-surface-variant);
    }

    .fix-suggestion {
      font-family: 'Roboto Mono', 'SF Mono', monospace;
      font-size: 12px;
      background: var(--md-surface-variant);
      padding: 4px 8px;
      border-radius: 4px;
      color: var(--md-on-surface-variant);
    }

    .no-issues {
      text-align: center;
      padding: 64px 24px;
      color: var(--md-success);
    }

    .no-issues svg {
      width: 64px;
      height: 64px;
      margin-bottom: 16px;
    }

    .no-issues h2 {
      margin-bottom: 8px;
    }

    .no-issues p {
      color: var(--md-on-surface-variant);
    }

    .pagination {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 16px;
      background: var(--md-surface-variant);
      border-top: 1px solid var(--md-outline);
    }

    .pagination-info {
      font-size: 13px;
      color: var(--md-on-surface-variant);
    }

    .pagination-controls {
      display: flex;
      gap: 8px;
    }

    .page-btn {
      background: var(--md-surface);
      border: 1px solid var(--md-outline);
      border-radius: 6px;
      padding: 6px 12px;
      font-size: 13px;
      cursor: pointer;
      color: var(--md-on-surface);
      transition: all 0.15s;
    }

    .page-btn:hover:not(:disabled) {
      background: var(--md-primary-container);
    }

    .page-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    footer {
      text-align: center;
      padding: 24px;
      color: var(--md-on-surface-variant);
      font-size: 12px;
    }

    .trace-id {
      font-family: 'Roboto Mono', monospace;
      font-size: 11px;
      color: var(--md-on-surface-variant);
      opacity: 0.7;
    }

    .export-dropdown {
      position: relative;
    }

    .export-menu {
      position: absolute;
      top: 100%;
      right: 0;
      margin-top: 4px;
      background: var(--md-surface);
      border: 1px solid var(--md-outline);
      border-radius: 8px;
      box-shadow: 0 4px 12px var(--md-shadow);
      display: none;
      z-index: 100;
      min-width: 140px;
    }

    .export-menu.open {
      display: block;
    }

    .export-menu button {
      display: block;
      width: 100%;
      padding: 10px 16px;
      background: none;
      border: none;
      text-align: left;
      cursor: pointer;
      font-size: 14px;
      color: var(--md-on-surface);
    }

    .export-menu button:hover {
      background: var(--md-surface-variant);
    }

    .export-menu button:first-child {
      border-radius: 8px 8px 0 0;
    }

    .export-menu button:last-child {
      border-radius: 0 0 8px 8px;
    }

    .table-container {
      max-height: 500px;
      overflow-y: auto;
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="header-left">
        <h1>Bun Enterprise Scanner</h1>
        <div class="score-badge" id="scoreBadge">--/100</div>
      </div>
      <div class="header-actions">
        <button class="theme-toggle" onclick="toggleTheme()">
          <span id="themeIcon">&#x1F319;</span>
          <span id="themeLabel">Dark</span>
        </button>
        <div class="export-dropdown">
          <button class="export-btn" onclick="toggleExportMenu()">
            &#x1F4E5; Export
          </button>
          <div class="export-menu" id="exportMenu">
            <button onclick="exportJSON()">JSON</button>
            <button onclick="exportCSV()">CSV</button>
            <button onclick="exportMarkdown()">Markdown</button>
          </div>
        </div>
      </div>
    </header>

    <div class="summary-grid" id="summaryGrid">
      <div class="summary-card">
        <div class="value" id="filesCount">--</div>
        <div class="label">Files Scanned</div>
      </div>
      <div class="summary-card">
        <div class="value" id="linesCount">--</div>
        <div class="label">Lines Analyzed</div>
      </div>
      <div class="summary-card">
        <div class="value" id="issuesCount">--</div>
        <div class="label">Issues Found</div>
      </div>
      <div class="summary-card">
        <div class="value" id="cleanFiles">--</div>
        <div class="label">Clean Files</div>
      </div>
    </div>

    <div class="severity-chart" id="severityChart">
      <h3>Issues by Severity</h3>
      <div class="chart-bars" id="chartBars"></div>
    </div>

    <div class="main-content">
      <div class="file-tree">
        <h3>Files</h3>
        <div id="fileList"></div>
      </div>

      <div class="issues-panel">
        <div class="filter-bar">
          <div class="filter-group">
            <label>Severity</label>
            <select class="filter-select" id="severityFilter" onchange="applyFilters()">
              <option value="">All</option>
              <option value="error">Error</option>
              <option value="warning">Warning</option>
              <option value="info">Info</option>
            </select>
          </div>
          <div class="filter-group">
            <label>Category</label>
            <select class="filter-select" id="categoryFilter" onchange="applyFilters()">
              <option value="">All</option>
            </select>
          </div>
          <div class="filter-group">
            <input type="text" class="search-input" id="searchInput" placeholder="Search issues..." oninput="applyFilters()">
          </div>
        </div>

        <div class="table-container">
          <table class="issues-table">
            <thead>
              <tr>
                <th onclick="sortBy('file')">File <span class="sort-icon">&#x2195;</span></th>
                <th onclick="sortBy('line')">Line <span class="sort-icon">&#x2195;</span></th>
                <th onclick="sortBy('severity')">Severity <span class="sort-icon">&#x2195;</span></th>
                <th onclick="sortBy('category')">Category <span class="sort-icon">&#x2195;</span></th>
                <th>Issue</th>
                <th>Suggested Fix</th>
              </tr>
            </thead>
            <tbody id="issuesBody"></tbody>
          </table>
        </div>

        <div id="noIssues" class="no-issues" style="display: none;">
          <svg viewBox="0 0 24 24" fill="currentColor">
            <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
          </svg>
          <h2>No Issues Found</h2>
          <p>Your codebase passes all checks.</p>
        </div>

        <div class="pagination" id="pagination">
          <div class="pagination-info" id="paginationInfo">Showing 1-20 of 92 issues</div>
          <div class="pagination-controls">
            <button class="page-btn" id="prevBtn" onclick="prevPage()">&#x2190; Prev</button>
            <button class="page-btn" id="nextBtn" onclick="nextPage()">Next &#x2192;</button>
          </div>
        </div>
      </div>
    </div>

    <footer>
      <p>Generated by Bun Enterprise Scanner v3.0</p>
      <p class="trace-id">Trace ID: <span id="traceId"></span> | <span id="timestamp"></span></p>
    </footer>
  </div>

  <script>
    // Embedded scan results
    const scanResults = [{"path":"/Users/nolarose/enterprise-dashboard/src/client/RegistryClient.ts","shortName":"RegistryClient.ts","lines":60,"issues":[],"score":100},{"path":"/Users/nolarose/enterprise-dashboard/src/shortcuts/KeyboardShortcutManager.ts","shortName":"KeyboardShortcutManager.ts","lines":230,"issues":[{"file":"KeyboardShortcutManager.ts","line":208,"column":6,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"}],"score":95},{"path":"/Users/nolarose/enterprise-dashboard/src/shortcuts/index.ts","shortName":"index.ts","lines":77,"issues":[{"file":"index.ts","line":35,"column":4,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"},{"file":"index.ts","line":50,"column":4,"rule":"require_usage","category":"COMPAT","message":"Use ESM import syntax for better tree-shaking","fix":"Use ESM import syntax for better tree-shaking","severity":"info"}],"score":90},{"path":"/Users/nolarose/enterprise-dashboard/src/polish/index.ts","shortName":"index.ts","lines":63,"issues":[],"score":100},{"path":"/Users/nolarose/enterprise-dashboard/src/polish/hooks.ts","shortName":"hooks.ts","lines":197,"issues":[],"score":100},{"path":"/Users/nolarose/enterprise-dashboard/src/dashboard/RegistryViewer.ts","shortName":"RegistryViewer.ts","lines":243,"issues":[{"file":"RegistryViewer.ts","line":238,"column":4,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"},{"file":"RegistryViewer.ts","line":240,"column":4,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"}],"score":90},{"path":"/Users/nolarose/enterprise-dashboard/src/dashboard/security-enhanced.ts","shortName":"security-enhanced.ts","lines":139,"issues":[{"file":"security-enhanced.ts","line":87,"column":4,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"},{"file":"security-enhanced.ts","line":88,"column":4,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"},{"file":"security-enhanced.ts","line":100,"column":4,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"},{"file":"security-enhanced.ts","line":102,"column":4,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"},{"file":"security-enhanced.ts","line":130,"column":2,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"}],"score":75},{"path":"/Users/nolarose/enterprise-dashboard/src/dashboard/KeychainViewer.ts","shortName":"KeychainViewer.ts","lines":75,"issues":[{"file":"KeychainViewer.ts","line":72,"column":2,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"},{"file":"KeychainViewer.ts","line":73,"column":2,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"}],"score":90},{"path":"/Users/nolarose/enterprise-dashboard/src/dashboard/SecurityAudit.ts","shortName":"SecurityAudit.ts","lines":275,"issues":[{"file":"SecurityAudit.ts","line":273,"column":2,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"}],"score":95},{"path":"/Users/nolarose/enterprise-dashboard/src/dashboard/index.ts","shortName":"index.ts","lines":167,"issues":[{"file":"index.ts","line":28,"column":0,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"},{"file":"index.ts","line":31,"column":0,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"},{"file":"index.ts","line":47,"column":2,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"},{"file":"index.ts","line":48,"column":2,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"},{"file":"index.ts","line":51,"column":0,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"},{"file":"index.ts","line":156,"column":2,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"}],"score":70},{"path":"/Users/nolarose/enterprise-dashboard/src/dashboard/modules/terminal.ts","shortName":"terminal.ts","lines":125,"issues":[{"file":"terminal.ts","line":84,"column":2,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"},{"file":"terminal.ts","line":85,"column":2,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"},{"file":"terminal.ts","line":86,"column":2,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"},{"file":"terminal.ts","line":87,"column":2,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"},{"file":"terminal.ts","line":91,"column":2,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"},{"file":"terminal.ts","line":100,"column":2,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"}],"score":70},{"path":"/Users/nolarose/enterprise-dashboard/src/dashboard/modules/metrics.ts","shortName":"metrics.ts","lines":99,"issues":[{"file":"metrics.ts","line":53,"column":4,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"},{"file":"metrics.ts","line":73,"column":2,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"},{"file":"metrics.ts","line":74,"column":2,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"},{"file":"metrics.ts","line":75,"column":2,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"},{"file":"metrics.ts","line":81,"column":2,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"}],"score":75},{"path":"/Users/nolarose/enterprise-dashboard/src/utils/dns-toolkit.ts","shortName":"dns-toolkit.ts","lines":564,"issues":[{"file":"dns-toolkit.ts","line":206,"column":19,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"},{"file":"dns-toolkit.ts","line":214,"column":19,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"},{"file":"dns-toolkit.ts","line":222,"column":19,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"},{"file":"dns-toolkit.ts","line":236,"column":8,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"}],"score":80},{"path":"/Users/nolarose/enterprise-dashboard/src/utils/bun-power-tools.ts","shortName":"bun-power-tools.ts","lines":245,"issues":[{"file":"bun-power-tools.ts","line":69,"column":4,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"},{"file":"bun-power-tools.ts","line":77,"column":4,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"},{"file":"bun-power-tools.ts","line":87,"column":6,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"},{"file":"bun-power-tools.ts","line":219,"column":4,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"},{"file":"bun-power-tools.ts","line":227,"column":4,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"}],"score":75},{"path":"/Users/nolarose/enterprise-dashboard/src/utils/index.ts","shortName":"index.ts","lines":13,"issues":[],"score":100},{"path":"/Users/nolarose/enterprise-dashboard/src/utils/google-bun-bridge.ts","shortName":"google-bun-bridge.ts","lines":883,"issues":[{"file":"google-bun-bridge.ts","line":227,"column":4,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"},{"file":"google-bun-bridge.ts","line":278,"column":4,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"}],"score":90},{"path":"/Users/nolarose/enterprise-dashboard/src/shell/pty.ts","shortName":"pty.ts","lines":257,"issues":[],"score":100},{"path":"/Users/nolarose/enterprise-dashboard/src/core/BunToolkit.ts","shortName":"BunToolkit.ts","lines":216,"issues":[{"file":"BunToolkit.ts","line":39,"column":6,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"},{"file":"BunToolkit.ts","line":112,"column":4,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"},{"file":"BunToolkit.ts","line":143,"column":6,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"}],"score":85},{"path":"/Users/nolarose/enterprise-dashboard/src/core/features.ts","shortName":"features.ts","lines":110,"issues":[{"file":"features.ts","line":73,"column":4,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"},{"file":"features.ts","line":85,"column":6,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"}],"score":90},{"path":"/Users/nolarose/enterprise-dashboard/src/core/index.ts","shortName":"index.ts","lines":27,"issues":[],"score":100},{"path":"/Users/nolarose/enterprise-dashboard/src/ui/table.ts","shortName":"table.ts","lines":152,"issues":[{"file":"table.ts","line":115,"column":2,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"}],"score":95},{"path":"/Users/nolarose/enterprise-dashboard/src/ui/bookmarks.ts","shortName":"bookmarks.ts","lines":709,"issues":[{"file":"bookmarks.ts","line":309,"column":4,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"},{"file":"bookmarks.ts","line":312,"column":4,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"},{"file":"bookmarks.ts","line":315,"column":6,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"},{"file":"bookmarks.ts","line":337,"column":4,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"},{"file":"bookmarks.ts","line":347,"column":4,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"},{"file":"bookmarks.ts","line":348,"column":4,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"},{"file":"bookmarks.ts","line":351,"column":6,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"},{"file":"bookmarks.ts","line":355,"column":4,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"},{"file":"bookmarks.ts","line":369,"column":4,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"},{"file":"bookmarks.ts","line":383,"column":4,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"},{"file":"bookmarks.ts","line":384,"column":4,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"},{"file":"bookmarks.ts","line":409,"column":4,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"},{"file":"bookmarks.ts","line":414,"column":6,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"},{"file":"bookmarks.ts","line":417,"column":8,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"},{"file":"bookmarks.ts","line":432,"column":6,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"},{"file":"bookmarks.ts","line":440,"column":4,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"},{"file":"bookmarks.ts","line":441,"column":4,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"},{"file":"bookmarks.ts","line":454,"column":10,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"},{"file":"bookmarks.ts","line":457,"column":10,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"},{"file":"bookmarks.ts","line":462,"column":8,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"},{"file":"bookmarks.ts","line":463,"column":8,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"},{"file":"bookmarks.ts","line":505,"column":4,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"},{"file":"bookmarks.ts","line":585,"column":6,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"},{"file":"bookmarks.ts","line":601,"column":4,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"},{"file":"bookmarks.ts","line":675,"column":4,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"}],"score":0},{"path":"/Users/nolarose/enterprise-dashboard/src/ui/google-elements.ts","shortName":"google-elements.ts","lines":492,"issues":[{"file":"google-elements.ts","line":99,"column":4,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"},{"file":"google-elements.ts","line":100,"column":4,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"},{"file":"google-elements.ts","line":130,"column":4,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"},{"file":"google-elements.ts","line":137,"column":4,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"},{"file":"google-elements.ts","line":138,"column":4,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"},{"file":"google-elements.ts","line":166,"column":4,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"},{"file":"google-elements.ts","line":266,"column":2,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"},{"file":"google-elements.ts","line":279,"column":2,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"},{"file":"google-elements.ts","line":280,"column":2,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"},{"file":"google-elements.ts","line":282,"column":4,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"},{"file":"google-elements.ts","line":284,"column":2,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"},{"file":"google-elements.ts","line":299,"column":2,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"},{"file":"google-elements.ts","line":310,"column":2,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"},{"file":"google-elements.ts","line":323,"column":2,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"},{"file":"google-elements.ts","line":334,"column":2,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"},{"file":"google-elements.ts","line":344,"column":2,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"},{"file":"google-elements.ts","line":393,"column":4,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"},{"file":"google-elements.ts","line":438,"column":2,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"},{"file":"google-elements.ts","line":469,"column":2,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"},{"file":"google-elements.ts","line":470,"column":2,"rule":"console_log","category":"STYLE","message":"Remove console.log or use proper logging","fix":"Remove console.log or use proper logging","severity":"info"}],"score":0},{"path":"/Users/nolarose/enterprise-dashboard/src/ui/index.ts","shortName":"index.ts","lines":57,"issues":[],"score":100}];

    // State
    let allIssues = [];
    let filteredIssues = [];
    let currentPage = 1;
    let pageSize = 20;
    let sortColumn = "file";
    let sortDirection = "asc";
    let selectedFile = null;

    // Initialize
    document.addEventListener("DOMContentLoaded", function() {
      initializeData();
      renderSummary();
      renderSeverityChart();
      renderFileTree();
      populateCategoryFilter();
      applyFilters();
      document.getElementById("traceId").textContent = generateTraceId();
      document.getElementById("timestamp").textContent = new Date().toISOString();

      // Check for saved theme
      if (localStorage.getItem("theme") === "dark") {
        document.documentElement.setAttribute("data-theme", "dark");
        document.getElementById("themeIcon").innerHTML = "&#x2600;&#xFE0F;";
        document.getElementById("themeLabel").textContent = "Light";
      }
    });

    function generateTraceId() {
      return Array.from({ length: 8 }, function() {
        return Math.floor(Math.random() * 16).toString(16);
      }).join("");
    }

    // Smart path disambiguation
    var displayNames = {};

    function computeDisplayNames() {
      // Count basename occurrences
      var basenameCounts = {};
      scanResults.forEach(function(file) {
        var basename = file.shortName;
        basenameCounts[basename] = (basenameCounts[basename] || 0) + 1;
      });

      // Compute display names with auto-disambiguation
      scanResults.forEach(function(file) {
        var basename = file.shortName;
        var hasConflict = basenameCounts[basename] > 1;

        if (hasConflict) {
          // Extract parent directory from full path
          var pathParts = file.path.split("/");
          var parentIdx = pathParts.length - 2;
          if (parentIdx >= 0) {
            var parent = pathParts[parentIdx];
            // Strip @ prefix for monorepo packages
            if (parent.startsWith("@")) {
              parent = parent.substring(1);
            }
            displayNames[file.path] = {
              parent: parent,
              basename: basename,
              full: parent + "/" + basename
            };
          } else {
            displayNames[file.path] = { parent: null, basename: basename, full: basename };
          }
        } else {
          displayNames[file.path] = { parent: null, basename: basename, full: basename };
        }
      });
    }

    function getDisplayName(filePath, asHtml) {
      var info = displayNames[filePath];
      if (!info) return filePath.split("/").pop();

      if (asHtml && info.parent) {
        return '<span class="path-parent">' + info.parent + '/</span>' + info.basename;
      }
      return info.full;
    }

    function initializeData() {
      computeDisplayNames();
      allIssues = [];
      scanResults.forEach(function(file) {
        file.issues.forEach(function(issue) {
          allIssues.push(Object.assign({}, issue, {
            path: file.path,
            shortName: file.shortName,
            displayName: getDisplayName(file.path, false)
          }));
        });
      });
    }

    function renderSummary() {
      var totalFiles = scanResults.length;
      var totalLines = scanResults.reduce(function(sum, f) { return sum + f.lines; }, 0);
      var totalIssues = allIssues.length;
      var cleanFiles = scanResults.filter(function(f) { return f.issues.length === 0; }).length;
      var avgScore = Math.round(scanResults.reduce(function(sum, f) { return sum + f.score; }, 0) / totalFiles);

      document.getElementById("filesCount").textContent = totalFiles;
      document.getElementById("linesCount").textContent = totalLines.toLocaleString();
      document.getElementById("issuesCount").textContent = totalIssues;
      document.getElementById("cleanFiles").textContent = cleanFiles;

      var scoreBadge = document.getElementById("scoreBadge");
      scoreBadge.textContent = avgScore + "/100";
      scoreBadge.className = "score-badge " + (avgScore >= 90 ? "excellent" : avgScore >= 70 ? "good" : "poor");
    }

    function renderSeverityChart() {
      var severityCounts = { error: 0, warning: 0, info: 0 };
      allIssues.forEach(function(issue) {
        var sev = issue.severity || "info";
        severityCounts[sev] = (severityCounts[sev] || 0) + 1;
      });

      var maxCount = Math.max(severityCounts.error, severityCounts.warning, severityCounts.info, 1);
      var chartBars = document.getElementById("chartBars");
      chartBars.innerHTML = "";

      ["error", "warning", "info"].forEach(function(severity) {
        var count = severityCounts[severity];
        var percentage = Math.round((count / maxCount) * 100);

        var row = document.createElement("div");
        row.className = "chart-row";
        row.innerHTML = '<span class="chart-label">' + severity + '</span>' +
          '<div class="chart-bar-container">' +
          '<div class="chart-bar ' + severity + '" style="width: ' + percentage + '%">' + (count > 0 ? count : "") + '</div>' +
          '</div>' +
          '<span class="chart-count">' + count + '</span>';
        chartBars.appendChild(row);
      });
    }

    function renderFileTree() {
      var fileList = document.getElementById("fileList");
      fileList.innerHTML = "";

      scanResults.forEach(function(file) {
        var item = document.createElement("div");
        item.className = "file-item" + (file.issues.length > 0 ? " has-issues" : " clean");
        if (selectedFile === file.path) item.classList.add("active");

        var issueCount = file.issues.length;
        var displayHtml = getDisplayName(file.path, true);
        item.innerHTML = '<span class="file-name">' + displayHtml + '</span>' +
          '<span class="file-issue-count ' + (issueCount === 0 ? "clean" : "") + '">' +
          (issueCount === 0 ? "&#x2713;" : issueCount) + '</span>';
        item.onclick = function() {
          selectedFile = selectedFile === file.path ? null : file.path;
          renderFileTree();
          applyFilters();
        };
        fileList.appendChild(item);
      });
    }

    function populateCategoryFilter() {
      var categories = [];
      allIssues.forEach(function(i) {
        if (i.category && categories.indexOf(i.category) === -1) {
          categories.push(i.category);
        }
      });
      categories.sort();
      var select = document.getElementById("categoryFilter");
      categories.forEach(function(cat) {
        var option = document.createElement("option");
        option.value = cat;
        option.textContent = cat;
        select.appendChild(option);
      });
    }

    function applyFilters() {
      var severityFilter = document.getElementById("severityFilter").value;
      var categoryFilter = document.getElementById("categoryFilter").value;
      var searchTerm = document.getElementById("searchInput").value.toLowerCase();

      filteredIssues = allIssues.filter(function(issue) {
        if (severityFilter && issue.severity !== severityFilter) return false;
        if (categoryFilter && issue.category !== categoryFilter) return false;
        if (selectedFile && issue.path !== selectedFile) return false;
        if (searchTerm) {
          var searchable = (issue.displayName + " " + issue.message + " " + issue.category + " " + issue.rule).toLowerCase();
          if (searchable.indexOf(searchTerm) === -1) return false;
        }
        return true;
      });

      sortIssues();
      currentPage = 1;
      renderIssuesTable();
    }

    function sortBy(column) {
      if (sortColumn === column) {
        sortDirection = sortDirection === "asc" ? "desc" : "asc";
      } else {
        sortColumn = column;
        sortDirection = "asc";
      }
      sortIssues();
      renderIssuesTable();
    }

    function sortIssues() {
      var severityOrder = { error: 0, warning: 1, info: 2 };
      filteredIssues.sort(function(a, b) {
        var aVal, bVal;
        switch (sortColumn) {
          case "file": aVal = a.file; bVal = b.file; break;
          case "line": aVal = a.line; bVal = b.line; break;
          case "severity": aVal = severityOrder[a.severity] || 2; bVal = severityOrder[b.severity] || 2; break;
          case "category": aVal = a.category || ""; bVal = b.category || ""; break;
          default: aVal = a.file; bVal = b.file;
        }
        if (typeof aVal === "string") {
          return sortDirection === "asc" ? aVal.localeCompare(bVal) : bVal.localeCompare(aVal);
        }
        return sortDirection === "asc" ? aVal - bVal : bVal - aVal;
      });
    }

    function renderIssuesTable() {
      var tbody = document.getElementById("issuesBody");
      var noIssues = document.getElementById("noIssues");
      var pagination = document.getElementById("pagination");

      if (filteredIssues.length === 0) {
        tbody.innerHTML = "";
        noIssues.style.display = "block";
        pagination.style.display = "none";
        return;
      }

      noIssues.style.display = "none";
      pagination.style.display = "flex";

      var start = (currentPage - 1) * pageSize;
      var end = Math.min(start + pageSize, filteredIssues.length);
      var pageIssues = filteredIssues.slice(start, end);

      tbody.innerHTML = pageIssues.map(function(issue) {
        return '<tr>' +
          '<td><span class="file-link">' + getDisplayName(issue.path, true) + '</span></td>' +
          '<td><span class="line-number">' + issue.line + ':' + (issue.column || 0) + '</span></td>' +
          '<td><span class="severity-badge ' + (issue.severity || "info") + '">' + (issue.severity || "info") + '</span></td>' +
          '<td><span class="category-badge">' + (issue.category || "GENERAL") + '</span></td>' +
          '<td>' + issue.message + '</td>' +
          '<td><span class="fix-suggestion">' + (issue.fix || "-") + '</span></td>' +
        '</tr>';
      }).join("");

      document.getElementById("paginationInfo").textContent =
        "Showing " + (start + 1) + "-" + end + " of " + filteredIssues.length + " issues";
      document.getElementById("prevBtn").disabled = currentPage === 1;
      document.getElementById("nextBtn").disabled = end >= filteredIssues.length;
    }

    function prevPage() {
      if (currentPage > 1) {
        currentPage--;
        renderIssuesTable();
      }
    }

    function nextPage() {
      if (currentPage * pageSize < filteredIssues.length) {
        currentPage++;
        renderIssuesTable();
      }
    }

    function toggleTheme() {
      var isDark = document.documentElement.getAttribute("data-theme") === "dark";
      if (isDark) {
        document.documentElement.removeAttribute("data-theme");
        document.getElementById("themeIcon").innerHTML = "&#x1F319;";
        document.getElementById("themeLabel").textContent = "Dark";
        localStorage.setItem("theme", "light");
      } else {
        document.documentElement.setAttribute("data-theme", "dark");
        document.getElementById("themeIcon").innerHTML = "&#x2600;&#xFE0F;";
        document.getElementById("themeLabel").textContent = "Light";
        localStorage.setItem("theme", "dark");
      }
    }

    function toggleExportMenu() {
      document.getElementById("exportMenu").classList.toggle("open");
    }

    // Close export menu when clicking outside
    document.addEventListener("click", function(e) {
      if (!e.target.closest(".export-dropdown")) {
        document.getElementById("exportMenu").classList.remove("open");
      }
    });

    function exportJSON() {
      var data = {
        summary: {
          files: scanResults.length,
          lines: scanResults.reduce(function(sum, f) { return sum + f.lines; }, 0),
          issues: allIssues.length,
          score: Math.round(scanResults.reduce(function(sum, f) { return sum + f.score; }, 0) / scanResults.length)
        },
        files: scanResults,
        issues: filteredIssues
      };
      downloadFile(JSON.stringify(data, null, 2), "scan-report.json", "application/json");
    }

    function exportCSV() {
      var headers = ["File", "Line", "Column", "Severity", "Category", "Rule", "Message", "Fix"];
      var rows = filteredIssues.map(function(i) {
        return [getDisplayName(i.path, false), i.line, i.column || 0, i.severity, i.category, i.rule, '"' + i.message + '"', '"' + (i.fix || "") + '"'];
      });
      var csv = [headers.join(",")].concat(rows.map(function(r) { return r.join(","); })).join("\n");
      downloadFile(csv, "scan-report.csv", "text/csv");
    }

    function exportMarkdown() {
      var md = "# Scan Report\n\n";
      md += "**Score:** " + document.getElementById("scoreBadge").textContent + "\n\n";
      md += "| Metric | Value |\n|--------|-------|\n";
      md += "| Files | " + scanResults.length + " |\n";
      md += "| Lines | " + scanResults.reduce(function(sum, f) { return sum + f.lines; }, 0).toLocaleString() + " |\n";
      md += "| Issues | " + allIssues.length + " |\n\n";
      md += "## Issues\n\n";
      md += "| File | Line | Severity | Category | Message |\n";
      md += "|------|------|----------|----------|--------|\n";
      filteredIssues.slice(0, 100).forEach(function(i) {
        md += "| " + getDisplayName(i.path, false) + " | " + i.line + " | " + i.severity + " | " + i.category + " | " + i.message + " |\n";
      });
      downloadFile(md, "scan-report.md", "text/markdown");
    }

    function downloadFile(content, filename, type) {
      var blob = new Blob([content], { type: type });
      var url = URL.createObjectURL(blob);
      var a = document.createElement("a");
      a.href = url;
      a.download = filename;
      a.click();
      URL.revokeObjectURL(url);
    }
  </script>
</body>
</html>
